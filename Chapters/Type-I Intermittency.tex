\section{Type-I Intermittency}
\label{sec:type-I intermittency}

\subsection{History}
Intermittency is one type of transition between chaos and periodicity.
The investigation of intermittency was initiated in 1980 by Pomeau and Manneville~\cite{Pomeau1980}.
They were trying to explain an intermittent phenomenon in the fluid dynamics of convective fluids.
During this phenomenon, long periodic behavior was abruptly transformed to bursts of chaotic behavior as the experiment control parameter changed.
Subsequently, Pomeau and Manneville found analogous behavior in the Lorenz system [cite here].
Through a numerical study of this system, they introduced the concept of intermittency and classified it into three categories.~\cite{Pomeau1980}
\par
Since then, the study of intermittency has grown considerably.
Many new types of intermittent behaviors were found and investigated.
For better understanding of intermittency, modern statistical theory has been developed.
~\cite{Elaskar2017}

\subsection{Mathematical Motivation}
Intermittency is a behavior during which seemingly periodic phases in the trajectory of DDS are abruptly followed by chaotic bursts.
Periodic phases are called laminar.
Phases with chaotic bursts are called turbulent phases.
This naming convention originated in fluid dynamics which motivated study of intermittency.~\cite{Pomeau1980}
\par
\textcolor{darkred}{
To illustrate the concept of intermittency clearly, a new dynamical system is needed.
Let $(\mathbb{R}, \mathcal{P}_{\varepsilon})$ be a DDS.
Map $\mathcal{P}_{\varepsilon}(x) = \left[ (1+\varepsilon)x+(1-\varepsilon)x^2 \right] \mod{1}$ is called the Pomeau-Manneville map [cite here].
With this map, intermittency is clearly visible in its trajectory.
This trajectory is diplayed in Figure~\ref{fig:intermittent_trajectory_example}.
Seemingly 2-periodic behavior which lasts for about 1000 iterations is interrupted by short chaotic bursts.
These chaotic bursts transform into 2-periodic behavior.
This pattern continues.
}

\begin{figure}[!h]
    \centering
    \includegraphics[width=1.0\textwidth]{Figures/type_one_intermittency_example1.png}
    \caption{
        \textcolor{darkred}{
        Trajectory $T^{5500}_{0}(\mathcal{P}_{\varepsilon}, x_0)$ for $x_0 = 0.5$ and $\varepsilon = 4.47458$.
        }
    }
    \label{fig:intermittent_trajectory_example}
\end{figure}

The trajectory in Figure~\ref{fig:intermittent_trajectory_example} exhibits type-I intermittency which is related to \hyperref[def:saddle_node_bif]{saddle-node bifurcation} or its inverse.
Saddle-node bifurcation is a bifurcation in which the tangent of a graph of a map passes through the identity line as parameter changes.
\par
Let parameter $p_{B}$ be a bifurcation point.
At this point, local map of the system touches the identity line in exactly one spot; in other words, the system has fixed point in the area of touching.
For parameters $p < p_{B}$ there are two fixed points, and the curve is intersected in two places.
For parameters $p > p_{B}$ there is no fixed point, since the curve left the identity line.
This relation is illustrated in Figure~\ref{fig:saddle_node_bifurcation}.
The red dot in Figure~\ref{fig:saddle_node_bifurcation} is a fixed point for the curve at the bifurcation point $p_{B}$.
The blue dots in Figure~\ref{fig:saddle_node_bifurcation} are fixed points for the curve for the parameter $p < p_{B}$.
When $p > p_{B}$ is greater but very close to $p_{B}$ a channel forms.
\begin{figure}[!h]
    \centering
    \includegraphics[width=0.7\textwidth]{Figures/intermittency_i_local_map.png}
    \caption{
        \textcolor{darkred}{
        Saddle-node bifurcation of type-I intermittency local map $f(x) = p + x + x^2$ for different parameters. 
        Bifurcation parameter: $p_B = 0$.
        }
    }
    \label{fig:saddle_node_bifurcation}
\end{figure}


The reason why intermittency arises is illustrated in Figure~\ref{fig:intermittent_cobweb_example}.
When the dynamical system $f_p$ is about to undergo saddle-node or inverse saddle-node bifurcation as parameter $p$ changes, the graph of $f_p$ is getting closer to the identity function $g(x)=x$.
Just before they touch, a small passage is formed between the two curves.
If the point $x_n$ gets injected into the narrow passage, it takes many iterations for it to get out of this passage again.
The closer the curve of $f_p$ and the identity function is, the narrower the passage and the longer it gets to iterate through it.
An illustration of the iteration through narrow passage is in Figure~\ref{fig:intermittent_cobweb_example} plot B.
This iteration corresponds to the first laminar phase in Figure~\ref{fig:intermittent_trajectory_example}.
While the point is traveling through a narrow passage, on trajectory it looks as if he was not moving.
Hence, it looks periodic.
However, this seemingly periodic behavior is fake since once the point iterates through the narrow passage, it moves chaotically once again.

\begin{figure}[!h]
    \centering
    \includegraphics[width=1.0\textwidth]{Figures/type_one_intermittency_example2.png}
    \caption{
        \textcolor{darkred}{
        Cobweb diagram of $\mathcal{P}_{\varepsilon}^{2}$ for $x_0 = 0.5$ and $\varepsilon = 4.47458$.
        (a) $T^{472}_{38}(\mathcal{P}_{\varepsilon}^{2}, x_0)$. 
        (b) $T^{461}_{40}(\mathcal{P}_{\varepsilon}^{2}, x_0)$. 
        }
    }
    \label{fig:intermittent_cobweb_example}
\end{figure}

\subsection{Theory}

% \textcolor{red}{
% As mentioned in the before there are several types of intermittency.
% The basic types are type-I, type-II and type-III intermittency.~\cite{Pomeau1980}.
% There exists other types such as V, X, eyelet, ring, on-off and other~\cite{Elaskar2017}.
% This text focuses on type-I intermittency.
% }
% \par
\textcolor{red}{
For one dimensional maps, type-I intermittency is generated by a local map and a reinjection mechanism.
The local map for type-I intermittency looks like this:
\begin{equation}
\varepsilon + x + a x^2 \label{eq:int_I_local_map}
\end{equation}
This local map is the same for any DDS exhibiting type-I intermittency.
The reinjection mechanism depends on the specific DDS.
This mechanism dictates how the point is reinjected from a chaotic region to the laminar region.
Laminar region is the narrow passage described earlier, in which the trajectory is laminar.
The chaotic region is the region outside the laminar region.
% The probability that a point gets mapped from the chaotic region back into the laminar region is described by the reinjection probability density function (RPD function).~\cite{Elaskar2022}
}
\par
\textcolor{red}{
In the next chapter the notion of laminar length and average laminar length will be needed.
The laminar length is the number of iterations a point spends in the laminar region.
For a mathematical description of laminar length, few other notions need to be explained first.
}
\par
\textcolor{red}{
The local map \ref{eq:int_I_local_map} is related to the saddle-node bifurcation.
During saddle-node bifurcation, two fixed points combine into one.
This fixed point shall be denoted $x^{*}$.
Let $(X, f)$ be a DDS. Suppose that $f$ undergoes saddle-node bifurcation and $x^{*}$ is the mentioned fixed point.
The pre-reinjection point $x_p$ is a point such that there exists a point $x_r = f(x_p)$ and $x_r \in I_l$ is in the laminar interval $I_l = [ x^{*}-c, x^{*}+c ]$.
The point $x_r$ shall be called a reinjected point.
$c$ is relatively small number corresponding to the width of the laminar region.
In this case, the laminar region is considered to be an interval around $x^{*}$.
}
\par
\textcolor{red}{
The Figure~\ref{fig:pre_reinjection_example} illustrates the idea of pre-reinjection points and laminar interval $I_l$.
Note that the curve in subfigure (b) locally resembles the local map \ref{eq:int_I_local_map} around the point $x^{*}$.
}
\begin{figure}[!h]
    \centering
    \begin{subfigure}{0.49\textwidth}
        \centering
        \includegraphics[width=\textwidth]{Figures/pre_reinjection_points_example{1}.png}
        \caption{}
    \end{subfigure}
    \hfill
    \begin{subfigure}{0.49\textwidth}
        \centering
        \includegraphics[width=\textwidth]{Figures/pre_reinjection_points_example{2}.png}
        \caption{}
    \end{subfigure}

    \caption{
        \textcolor{darkred}{ 
        Pre-reinjection points and laminar interval of $\mathcal{L}_{r}^{3}(x+x^{*})-x^{*}$ for $r = 3.827$ and $x^{*} \approxeq 0.51435$.
        (a) the full graph. 
        (b) a close-up to a region of interest. 
        Red dots: pre-reinjection points.
        Blue dots: reinjected points.
        Laminar interval: $I_l = [ x^{*}-c, x^{*}+c ]$ for $c = 0.03$.
        Orange line: $I_l$.
        Green dot: $x^{*}$.
        }
    }
    \label{fig:pre_reinjection_example}
\end{figure}
\par
\textcolor{red}{
Consider that $0 < \varepsilon \ll 1$.
By using the Equation~\eqref{eq:int_I_local_map} the difference between two successive points $x_n - x_{n-1} \approx dx/dl$ can be written as:
\begin{equation}
\frac{dx}{dl} = \varepsilon + a x^2 \label{eq:int_I_diff_eq}
\end{equation}
Thus continuous differential equation is obtained.
Solving from reinjected point $x$ to the end of laminar interval $c$ yields:
\begin{equation}
\int_{x}^{c} \frac{dx}{\varepsilon + a x^2} = \int_{0}^{l} dl \label{eq:int_I_diff_eq_step1}
\end{equation}
Solving for $l$ results in:
\begin{equation}
    l(x, c) = \frac{1}{\sqrt{a \varepsilon}} \left( tan^{-1} \left( c \sqrt{\frac{a}{\varepsilon}} \right) - tan^{-1} \left( x \sqrt{\frac{a}{\varepsilon}} \right) \right) \label{eq:laminar_length}
\end{equation}
}
\textcolor{red}{
Hence for a given reinjected point $x$ and laminar interval width $c$ the laminar length $l$ can be calculated.
By calculating laminar length for many reinjected points and some fixed $c$ the average laminar length $l_{avg}$ can be calculated.
However, that is not very practical since it is not always clear how to choose $c$.
Fortunately, a so-called characteristic relation of type-I intermittency was formulated.
}

\subsubsection{Characteristic Relation}
\textcolor{red}{
To estimate the average laminar length $l_{avg}$ based on the parameter $\varepsilon$ a characteristic relation was formulated [cite here].
It holds that $l_{avg} \propto 1/\sqrt{\varepsilon}$.
This relation states that the average laminar $l_{avg}$ length is inversely proportional to the square root of the parameter $\varepsilon$.
Thus, by calculating $\varepsilon$ of the local map in the vicinity of a fixed point $x^{*}$ the $l_{avg}$ can be estimated.
}
\par
\textcolor{red}{
To verify that the characteristic relation of type-I intermittency holds, a numerical simulation was conducted.
The relation is verified for the third iterate of the Logistic map $\mathcal{L}_{r}^{3}$.
}
\par
\textcolor{red}{
The third iterate of Logistic map $\mathcal{L}_{r}^{3}$ undergoes saddle-node bifurcation at $r = 1+\sqrt{8}$ [cite here].
This parameter shall be denoted as $r^{*}$.
$r^{*}$ is the start of the $3$-periodic window, the biggest periodic window visible in the bifurcation diagram of $\mathcal{L}_{r}$.
It can be seen in Figure~\ref{fig:bif_diag_example}.
There are three fixed points associated with the bifurcation, $x^{*}_{1} \approx 0.1599$, $x^{*}_{2} \approx 0.5143$ and $x^{*}_{3} \approx 0.9563$.
For parameter $r$ slightly less than $r^{*}$, $\mathcal{L}_{r}^{3}$ resembles the local map \ref{eq:int_I_local_map} in the proximity of the three mentioned fixed points.
The following explanation of the simulation will use $x^{*}_{1}$ as an example.
The simulation can be conducted in the same way for $x^{*}_{2}$ and $x^{*}_{3}$.
}
\par
\textcolor{red}{
The goal is to compute the average laminar length $l_{avg}$ for a point traveling through the laminar region around $x^{*}_{1}$.
The laminar region exists for the parameters $r$ slightly less than $r^{*}_{1}$.
In the experiment $30$ parameters $r$ were randomly chosen from the interval $[ r^{*}-10^{-5}, r^{*}-10^{-13} ]$.
Subsequently, the corresponding $\varepsilon$ parameters were calculated.
}
\par
\textcolor{red}{
To calculate $\varepsilon$ for the local map around $x^{*}_{1}$, the map $\mathcal{L}_{r}^{3}$ was shifted so that $x^{*}_{1}$ is in the origin.
In other words, $\mathcal{L}_{shift}(x) = \mathcal{L}_{r}^{3}(x + x^{*}_{1}) - x^{*}_{1}$.
Parameters $\varepsilon$ and $a$ are calculated using the Taylor polynomial of $\mathcal{L}_{shift}(x)$ at $x = 0$.
Hence, $\varepsilon = | \mathcal{L}_{shift}(0) |$ and $a = \mathcal{L}_{shift}''(0) / 2$.
$\varepsilon$ and $a$ are calculated for each of the $30$ random $r$ parameters.
Next, they are used to calculate the laminar length.
}
\par
\textcolor{red}{
To calculate the laminar length $l$ (Equation~\eqref{eq:laminar_length}) corresponding to one $r$, reinjection point $x$, laminar interval width $c$, $\varepsilon$ and $a$ are needed.
The laminar interval width $c$ in the experiment was selected as $0.01, 0.03, 0.05$ and $0.07$.
In the following explanation, $c = 0.01$.
The same procedure can be done for the remaining $c$'s.
$c$, $\varepsilon$ and $a$ are known.
Next reinjection points $x$ are calculated.
}
\par
\textcolor{red}{
To calculate the reinjection points corresponding to one of the $30$ $r$'s, the following procedure is used.
A point $x$ is randomly chosen from $[ 0-x^{*}_{1}, 1-x^{*}_{1} ]$.
Consequently, a check is conducted if the point gets reinjected into laminar interval.
In other words, check if $| \mathcal{L}_{shift}(x) | < c$.
The procedure is repeated until $N = 4000$ reinjected points are obtained.
}
\par
\textcolor{red}{
For each reinjected point $x$ and the laminar length $l$ is calculated using Equation~\eqref{eq:laminar_length}.
Then, their average is calculated.
}
\par
\textcolor{red}{
The procedure is repeated for each of the $30$ $r$'s.
The results are plotted in log-log scale.
A linear fit of the results is calculated.
}
\par
\textcolor{red}{
The results are shown in Figure~\ref{fig:characteristic_relation_fit}.
Note that the results support that the $l_{avg} \propto 1/\sqrt(\varepsilon) = \varepsilon ^ {-1/2}$.
The linear fit for different $c$'s and $x^{*}$ is shown.
}
\par
\textcolor{red}{
Also note that it holds $l_{avg} \propto \varepsilon ^ {-1/2} \implies log_{10}(l_{avg}) \propto -1/2 \cdot \log_{10}(\varepsilon)$.
The Figure~\ref{fig:characteristic_relation_fit} shows that the slope of the linear fits is approximately $-1/2$.
That implies that the characteristic relation of type-I intermittency holds. 
}

\begin{figure}[!h]
    \centering
    \begin{subfigure}{0.49\textwidth}
        \centering
        \includegraphics[width=\textwidth]{Figures/characteristic_relation_fit{1}.png}
        \caption{}
    \end{subfigure}
    \hfill
    \begin{subfigure}{0.49\textwidth}
        \centering
        \includegraphics[width=\textwidth]{Figures/characteristic_relation_fit{2}.png}
        \caption{}
    \end{subfigure}
    \hfill
    \begin{subfigure}{0.49\textwidth}
        \centering
        \includegraphics[width=\textwidth]{Figures/characteristic_relation_fit{3}.png}
        \caption{}
    \end{subfigure}

    \caption{
        % \textcolor{red}{ 
        % A numerical simulation verifying the characteristic relation of type-I intermittency.
        % Third iterate of the Logistic map $\mathcal{L}_{r}^{3}$ was used.
        % Parameter $r^{*} = 1 + \sqrt{8}$ is the saddle-node bifurcation parameter.
        % The fixed points of $\mathcal{L}_{r^{*}}^{3}$ are $x^{*}_{1} = 0.1599$, $x^{*}_{2} = 0.5143$ and $x^{*}_{3} = 0.9563$.
        % Average laminar length $l_{avg}$ was measured for $N = 4000$ reinjected points.
        % Laminar lengths were obtained using Equation~\eqref{eq:laminar_length}. 
        % Parameter $c$ is fixed as $0.01, 0.03, 0.05$ or $0.07$.
        % $30$ parameters $r$ were randomly chosen from interval $[ r^{*}-10^{-5}, r^{*}-10^{-13} ]$.
        % The $30$ corresponding $\varepsilon$ parameters were calculated.
        % The red points are the numerical $l_{avg}$ results.
        % The colorful lines are a linear fit of the numerical results.
        % $s$ in the legend is the slope of the linear fit.
        % (a) corresponds to $x^{*}_{1}$. 
        % (b) corresponds to $x^{*}_{2}$. 
        % (c) corresponds to $x^{*}_{3}$. 
        % }
        \textcolor{darkred}{ 
        $x$-axis: $30$ random $r \in [ r^{*}-10^{-5}, r^{*}-10^{-13} ], r^{*} = 1 + \sqrt{8}$ selected, corresponding $\varepsilon$ are calculated.
        $y$-axis: average $l_{avg}$ of laminar lengths (Equation~\eqref{eq:laminar_length}) for $4000$ points reinjected into laminar interval $I_{c} = [x^{*}-c, x^{*}+c], c \in \{ 0.01, 0.03, 0.05, 0.07 \}$ is calculated.
        Colorful lines: linear fit.
        Constant $s$: slope of the linear fit.
        Fixed point $x^{*}$: (a) $x^{*} = 0.1599$ (b) $x^{*} = 0.5143$ and (c) $x^{*} = 0.9563$.
        DDS: $\mathcal{L}_{r}^{3}$.
        }
    }
    \label{fig:characteristic_relation_fit}
\end{figure}


% \section{Numerical Simulation}
% We propose that type-I intermittency occurs when there is a breakpoint in bifurcation diagram between chaotic behavior on the left and periodic behavior on the right.
% % Such break point is illustrated in Figure~\ref{fig:complex_logistic} subplot c and d.
% We have not found literature to support this claim yet.
% However, our numerical simulations support this claim.
% Results are presented in Figures~\ref{fig:complex_pomeau_manneville},~\ref{fig:complex_logistic},~\ref{fig:complex_henon},~\ref{fig:complex_duffing}.
% In plots marked as D in each of these figures, the breakpoint in bifurcation diagram is shown.
% In plots marked as E in each of these figures, intermittent evolution near the breakpoint is shown.
% \par
% Since left side of the breakpoint is chaotic and right side is periodic, there must be a transition from chaos to stability.
% This transition is related to intermittency and narrow passage mentioned in Figure~\ref{fig:intermittent_cobweb_example}.
% (Claim) The breakpoint corresponds to the value of saddle-node bifurcation.
% This breakpoint shall be denoted as $\varepsilon_{sn}$.
% The closer the parameter $\varepsilon$ gets to breakpoint $\varepsilon_{sn}$ the narrower the passage gets.
% Hence it takes more iterations to iterate through the passage.
% Hence laminar phases visible in the trajectory get longer and longer as $\varepsilon$ gets closer to $\varepsilon_{sn}$.
% Hence $\varepsilon \rightarrow \varepsilon_{sn} \implies l_{avg} \rightarrow \infty$ where $l_{avg}$ is the average length of laminar phase.
% When $\varepsilon = \varepsilon_{sn}$ behavior is periodic.
% (End Of Claim)

\subsection{Ambiguous Bifurcation Diagram}
\label{sec:ambiguous_bif_diag}
How does the bifurcation diagram look for an intermittent region?
During the creation of a bifurcation diagram, some fixed number of iterations are plotted.
Based on the number of total iterations and number of last iterations being plotted, the bifurcation diagram may differ.
When plotting a subsection of the trajectory that corresponds only to the laminar phase, the behavior during the turbulent phase is omited.
This causes the bifurcation diagram to look different depending on how many iterations are made and how long the sample period is.
\par
\begin{figure}[!h]
    \centering
    \includegraphics[width=1.0\textwidth]{Figures/bif_diag_ambiguity_creation_sketch.png}
    \caption{
        \textcolor{darkred}{
        Sketch describing how to create an ambiguous bifurcation diagram. 
        Red graph: $T^{17000}_{0}(\mathcal{P}_{4.47458285}, x_0)$. 
        Blue graph: $T^{17000}_{0}(\mathcal{P}_{4.47458285+4 \cdot 10^{-8}}, x_0)$. 
        Initial condition: $x_0 = 0.5$.
        }
    }
    \label{fig:ambiguous_bif_diag}
\end{figure}

To illustrate this ambiguity in bifurcation diagram, one can simply create a generic example.
Figure~\ref{fig:ambiguous_bif_diag} shows two trajectories for two distinct parameters $p_1$ and $p_2$.
Both are close to the intermittency threshold (break point) $p_{sn}$ and it holds $p_1 < p_2 < p_{sn}$.
The trajectory for parameter $p_1$ is plotted in red in Figure~\ref{fig:ambiguous_bif_diag}.
The trajectory for $p_2$ is blue.
Since $p_2$ is closer to the intermittency threshold $p_{sn}$, the laminar phases of its trajectories are longer.
% Parameters $p_1$ and $p_2$ can be selected arbitrarily as long as theso that the laminar phases are long enough and similar situation as in Figure~\ref{fig:ambiguous_bif_diag} occurs.
Chaotic burst of the trajectory with a longer laminar phase occurs in the middle of two laminar phases of the trajectory with shorter laminar phases.
In our case, the chaotic burst $b$ occurs between chaotic bursts $a$ and $c$.
When creating two bifurcation diagrams with total number of iterations $0.95 c$ and plotting the last $c-(b-0.25(b-a))$ or $c-(b-0.75(b-a))$ iterations, two distinct bifurcation diagrams are obtained.

\begin{figure}[!h]
    \centering
    \begin{subfigure}{0.85\textwidth}
        \centering
        \includegraphics[width=\textwidth]{Figures/pomeau_manneville_bif_comparison_big{1}.png}
        \caption{}
    \end{subfigure}
    \hfill
    \begin{subfigure}{0.85\textwidth}
        \centering
        \includegraphics[width=\textwidth]{Figures/pomeau_manneville_bif_comparison_big{2}.png}
        \caption{}
    \end{subfigure}
    \begin{subfigure}{0.85\textwidth}
        \centering
        \includegraphics[width=\textwidth]{Figures/pomeau_manneville_bif_comparison_big{3}.png}
        \caption{}
    \end{subfigure}
    \begin{subfigure}{0.85\textwidth}
        \centering
        \includegraphics[width=\textwidth]{Figures/pomeau_manneville_bif_comparison_big{4}.png}
        \caption{}
    \end{subfigure}

    \caption{
        \textcolor{darkred}{ 
        Bifurcation diagrams of $\mathcal{P}_{\varepsilon}$ for $\varepsilon \in I := [4.4745829085, 4.4745829215]$.
        Interval $I$ is sampled to $400$ uniformly spaced points.
        Trajectories used for diagram construction:
        (a) $\mathcal{T}_{12000}^{25000}(\mathcal{P}_{\varepsilon}, x_0)$
        (b) $\mathcal{T}_{13900}^{25000}(\mathcal{P}_{\varepsilon}, x_0)$ 
        (c) $\mathcal{T}_{20000}^{25000}(\mathcal{P}_{\varepsilon}, x_0)$ 
        (d) $\mathcal{T}_{24000}^{25000}(\mathcal{P}_{\varepsilon}, x_0)$.
        Initial condition: $x_0 = 0.5$.
        % For each of the diagrams the initial condition is $x_0 = 0.5$, parameter intervals are sampled to $400$ uniformly spaced points and $25000$ iterations are computed. 
        % Last (a) $13000$, (b) $11100$, (c) $5000$, (d) $1000$  iterations are plotted.
        }
    }
    \label{fig:ambiguous_bif_diag_example}
\end{figure}




This is illustrated in Figure~\ref{fig:ambiguous_bif_diag_example}.
Figure shows that bifurcation diagrams differ significantly when the number of total iterations is the same, but the number of last iterations being plotted is different.
\par
A question arises what do we expect from a bifurcation diagram when we create it?
 Figure~\ref{fig:ambiguous_bif_diag_example} clearly shows that the same region of the bifurcation diagram can look very different.
A person not knowing about intermittency could be misled.
It would be useful to have a tool that would warn a person looking at the bifurcation diagram about underlying intermittency and ambiguity it is causing.
The next chapter introduces such a tool.