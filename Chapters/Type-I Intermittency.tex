\chapter{Type-I Intermittency}
\label{chap:type-I intermittency}

\textcolor{blue}{
This Chapter is concerned with the phenomena of intermittency, especially with type-I intermittency.
Firstly, discovery and history of intermittency is mentioned.
Then the cause of intermittency is motivated.
Furthermore, the idea of laminar length and charasteristic relation is introduced.
Lastly, the ambiguity of the bifurcation diagram caused by intermittency is explained.
}

\section{History}
\textcolor{blue}{
In 1949, the word intermittency was used in context of turbulent flows by Batchelor and Townsend~\cite{Batchelor19491025}.
They used the term to depict signals that altered between approximately flat periods and and burst ones~\cite{Elaskar2017}.
}
\par
\textcolor{blue}{
About three decades later, Pomeau and Manneville have studied intermittent transition to turbulence in an experiment with convective fluids~\cite{Pomeau1980}.
During this phenomenon, long periodic behavior was interrupted by chaotic bursts as the experiment control parameter changed.
They have shown that intermittent behavior is present in simple models such as the Lorenz model~\cite{Lorenz2004}.
Furthermore, they classified intermittency into three types based on model's Floquet multipliers.
They called these three types I, II and III.
}
\par
\textcolor{blue}{
Theoretical analysis of intermittency is centered around certain statistical properties, especially the reinjection probability density function.
Although standard theory considered this function constant~\cite{Dubois1983}, new advances in the field provide a more complex explanation~\cite{Elaskar2022}.
In addition, to the three original types of intermittency, many new types have been described since then.
Some of them are V, X, on-off, eyelet, and ring~\cite{Elaskar2022}.
}

\section{Motivation}
Intermittency is a behavior during which seemingly periodic phases in the trajectory of DDS are abruptly followed by chaotic bursts.
Periodic phases are called laminar.
Phases with chaotic bursts are called turbulent phases.
\par
\textcolor{blue}{
To illustrate the concept of intermittency, a new dynamical system is needed.
Let $([0, 1], \mathcal{P}_{\varepsilon})$ be a DDS.
The map $\mathcal{P}_{\varepsilon}(x) = \left[ (1+\varepsilon)x+(1-\varepsilon)x^2 \right] \mod{1}$ is called the Pomeau-Manneville map~\cite{Manneville1980,Datseris2022}.
Intermittency is clearly visible in the trajectory of $\mathcal{P}_{\varepsilon}$ shown in Figure~\ref{fig:intermittent_trajectory_example}.
Seemingly 2-periodic behavior which lasts for about 1000 iterations is interrupted by short chaotic bursts.
These chaotic bursts soon transform into seemingly 2-periodic behavior.
This pattern repeats.
}

\begin{figure}[!h]
    \centering
    \includegraphics[width=0.95\textwidth]{Figures/type_one_intermittency_example1.png}
    \caption{
        \textcolor{blue}{
        Trajectory $T^{5500}_{0}(\mathcal{P}_{\varepsilon}, x_0)$ for $x_0 = 0.5$ and $\varepsilon = 4.47458$.
        }
    }
    \label{fig:intermittent_trajectory_example}
\end{figure}

\textcolor{blue}{
Although there are many types of intermittency, the main focus of this thesis is on type-I intermittency~\cite{Pomeau1980,Bussac1982,DelRio2014}.
Such an intermittent behavior arises when a DDS $(X, f_{p})$ is about to undergo a saddle-node bifurcation.
This type of bifurcation occurs when the tangent of the graph of $f_{p}$ at the point $x^{*}$ is equivalent to the identity line.
Thus, the point $x^{*}$ is a fixed point, and $f_{p}'(x^{*}) = 1$.
As the parameter $p$ is slightly altered, the point $x^{*}$ either splits into two fixed points or vanishes.
}
\par
\textcolor{blue}{
An illustration of saddle-node bifurcation is shown in Figure~\ref{fig:saddle_node_bifurcation}.
A map $f_{p}(x) = p + x + x^2$ is displayed.
For $p = 0$, there is one single fixed point (red point).
The tangent of $f_{p}$ at the red point is $1$.
When $p$ increases slightly, the fixed point vanishes.
On the other hand, when $p$ is slightly decreased, two fixed points emerge (blue points).
Note that if $p$ is increased by a very small value, a narrow passage is formed between $f_{p}$ and the identity line.
Imagine that a cobweb diagram (Remark~\ref{def:cobweb}) is initited with initial condition $x_0$ close to the red point.
In that case, it would take many iterations for the point to iterate through the narrow passage.
The narrower the passage, the more iterations it would take.
}

\begin{figure}[!h]
    \centering
    \includegraphics[width=0.7\textwidth]{Figures/intermittency_i_local_map.png}
    \caption{
        \textcolor{blue}{
        Map $f_{p}(x) = p + x + x^2$ for different parameters $p$. 
        Parameter $p_B = 0$.
        }
    }
    \label{fig:saddle_node_bifurcation}
\end{figure}

\par
\textcolor{blue}{
Figure~\ref{fig:intermittent_cobweb_example} illustrates the iteration through a narrow passage.
There, the first laminar phase of Figure~\ref{fig:intermittent_trajectory_example} is shown through the eyes of a cobweb diagram.
The trajectory in Figure~\ref{fig:intermittent_trajectory_example} starts off with a chaotic burst but soon transforms into a stable behavior.
The reason for that is seen in Figure~\ref{fig:intermittent_cobweb_example}(a). The point got trapped in a narrow passage formed between the identity line and the graph.
It takes many iterations for the point to iterate through the passage (Figure~\ref{fig:intermittent_cobweb_example}(b)).
Figure~\ref{fig:intermittent_cobweb_example}(c) shows a subset of a trajectory in Figure~\ref{fig:intermittent_trajectory_example}.
The subset corresponds to the iteration through a narrow passage.
Once the point escapes the narrow passage, it moves chaotically before being reinjected back into the narrow passage.
The second entrance into the narrow passage corresponds to the second laminar phase of Figure~\ref{fig:intermittent_trajectory_example}.
}

\begin{figure}[!h]
    \centering
    \includegraphics[width=0.95\textwidth]{Figures/type_one_intermittency_example2.png}
    \caption{
        \textcolor{blue}{
        Subfigures (a) and (b):
        Cobweb diagram of 
        (a) $T^{472}_{38}(\mathcal{P}_{\varepsilon}^{2}, x_0)$ and
        (b) $T^{461}_{40}(\mathcal{P}_{\varepsilon}^{2}, x_0)$. 
        Subfigure (c):
        Trajectory $T^{520}_{0}(\mathcal{P}_{\varepsilon}^{2}, x_0)$.
        Parameters: $x_0 = 0.5$ and $\varepsilon = 4.47458$.
        }
    }
    \label{fig:intermittent_cobweb_example}
\end{figure}

\par
\textcolor{blue}{
Intermittency can be thought of as a continuous route to chaos (or from chaos).
Intermittency type-I can be spotted in a bifurcation diagram as a breakpoint or a periodic window.
Such periodic window can be seen in Figure~\ref{fig:bif_diag_example} at $r = 1+\sqrt{8} \approx 3.82842$.
At this parameter, the nonperiodic behavior suddenly changed to the $3$-periodic behavior.
The process that caused this change is type-I intermittency.
When the parameter $r$ gets closer and closer to the breakpoint, the laminar phases of the trajectories become longer and longer until the whole trajectory becomes an infinitely long laminar phase.
}


\section{Laminar Phase Length}

\textcolor{blue}{
This section describes the notion of laminar phase length, which is the number of iterations a point spends in the narrow passage.
This notion and especially the notion of the average laminar phase length (or average laminar length for short) will be used in Chapter~\ref{chapter:intdetection}.
}
\par
\textcolor{blue}{
In the following text, the narrow passage between the graph and the identity shall be called \emph{laminar region} or \emph{laminar interval}.
The region outside of the laminar region shall be called \emph{turbulent region}.
}
\par
\textcolor{blue}{
The local shape of the graph above (or below) the laminar region determines the type of intermittency.
The local shape is also called the \emph{local map} \cite{Elaskar2017}.
For maps with type-I intermittency, the local map is the following:
\begin{equation}
\varepsilon + x + a x^2 \label{eq:int_I_local_map}
\end{equation}
However, a specific local map is not enough for intermittency to occur in a DDS.
A reinjection mechanism has to be present that reinjects the point from the turbulent region back into the laminar region.
This reinjection mechanism is described by the reinjection probability density function and depends on a specific DDS. \cite{Elaskar2017}
}
\par
\textcolor{blue}{
Let $(X, f_{p})$ be a DDS. Suppose that $f_{p}$ undergoes saddle-node bifurcation and $x^{*}$ is the corresponding single fixed point.
Suppose that $I_l = [ x^{*}-c, x^{*}+c ]$ is the laminar interval for some small $c$.
A \emph{pre-reinjection point} $x_p$ is a point that gets \emph{reinjected} into $I_l$, which means that there exists a point $x_r = f(x_p)$, $x_r \in I_l$.
The point $x_r$ shall be called a \emph{reinjected point}.
}
\par
The Figure~\ref{fig:pre_reinjection_example} illustrates the idea of pre-reinjection points and laminar interval $I_l$.
Note that the curve in subfigure (b) locally resembles the local map \eqref{eq:int_I_local_map} around the point $x^{*}$.
\begin{figure}[!h]
    \centering
    \begin{subfigure}{0.49\textwidth}
        \centering
        \includegraphics[width=\textwidth]{Figures/pre_reinjection_points_example{1}.png}
        \caption{}
    \end{subfigure}
    \hfill
    \begin{subfigure}{0.49\textwidth}
        \centering
        \includegraphics[width=\textwidth]{Figures/pre_reinjection_points_example{2}.png}
        \caption{}
    \end{subfigure}

    \caption{
        \textcolor{blue}{ 
        Pre-reinjection points and laminar interval of $\mathcal{L}_{r}^{3}(x+x^{*})-x^{*}$ for $r = 3.827$ and $x^{*} \approxeq 0.51435$.
        (a) the full graph. 
        (b) a close-up to a region of interest. 
        Red dots: pre-reinjection points.
        Blue dots: reinjected points.
        Laminar interval: $I_l = [ x^{*}-c, x^{*}+c ]$ for $c = 0.03$.
        Orange line: $I_l$.
        Green dot: $x^{*}$.
        }
    }
    \label{fig:pre_reinjection_example}
\end{figure}
\par
Consider that $0 < \varepsilon \ll 1$.
By using the Equation~\eqref{eq:int_I_local_map} the difference between two successive points $x_n - x_{n-1} \approx dx/dl$ can be written as:
\begin{equation}
\frac{dx}{dl} = \varepsilon + a x^2 \label{eq:int_I_diff_eq}
\end{equation}
Thus continuous differential equation is obtained.
Solving from reinjected point $x$ to the end of laminar interval $c$ yields:
\begin{equation}
\int_{x}^{c} \frac{dx}{\varepsilon + a x^2} = \int_{0}^{l} dl \label{eq:int_I_diff_eq_step1}
\end{equation}
Solving for $l$ results in \cite{Elaskar2017}:
\begin{equation}
    l(x, c) = \frac{1}{\sqrt{a \varepsilon}} \left( \tan^{-1} \left( c \sqrt{\frac{a}{\varepsilon}} \right) - \tan^{-1} \left( x \sqrt{\frac{a}{\varepsilon}} \right) \right) \label{eq:laminar_length}
\end{equation}

\par
Hence for a given reinjected point $x$ and the width of the laminar interval $c$ the laminar length $l$ can be calculated.
Laminar length means the number of iterations the point has to make to the end of laminar interval.
By calculating the laminar length for many reinjected points and some fixed $c$, the average laminar length $l_{avg}$ can be calculated.
However, that is not very practical since it is not always clear how to choose $c$.
Fortunately, this problem was solved by formulation of the so-called characteristic relation of type-I intermittency.

\section{Characteristic Relation}

\textcolor{blue}{
To estimate the average laminar length $l_{avg}$ based on the parameter $\varepsilon$ a characteristic relation was formulated~\cite{Elaskar2017}.
It holds that $l_{avg} \propto 1/\sqrt{\varepsilon}$.
This relation states that the average laminar length $l_{avg}$ is inversely proportional to the square root of the parameter $\varepsilon$.
Thus, by calculating $\varepsilon$ of the local map in the vicinity of a fixed point $x^{*}$ the $l_{avg}$ can be estimated.
}
\par
\textcolor{blue}{
To verify that the characteristic relation of type-I intermittency holds, a numerical simulation was conducted.
The Algorithm~\ref{alg:char_rel} describes the simulation.
}

\begin{algorithm}[!h]
    \caption{Characteristic Relation Verification}
    \label{alg:char_rel}
    \begin{algorithmic}[1]
        \Statex $f_{p} \gets$ map
        \Statex $p^{*} \gets$ saddle-node bifurcation parameter
        \Statex $xs \gets$ collection of fixed points of $f_{p^{*}}$
        \Statex $cs \gets$ collection of laminar interval widths
        \Statex $N \gets$ number of reinjected points
        \Statex $M \gets$ number of map parameters
        \Statex $A \gets$ intermittency region lower bound
        \Statex $B \gets$ intermittency region upper bound

        \State $ps \gets$ generate $M$ random parameters from $[p^{*}-A, p^{*}-B]$
        \For{$x_{0}$ in $xs$}
            \State $g_{p}(x) \gets f_{p}(x + x_0) - x_0$   $\;\;\;$ // map is shifted to the origin
            \For{$c$ in $cs$}
                \For{$p_{0}$ in $ps$}
                    \State $rpoints \gets$ generate $N$ reinjected point into $[-c, c]$
                    \State $\varepsilon \gets g_{p_{0}}(0)$  $\;\;\;$   // the first term of Maclaurin series
                    \State $a \gets \frac{1}{2}g''_{p_{0}}(0)$  $\;\;\;$  // the third term of Maclaurin series
                    \State $ls \gets \emptyset$
                    \For{$x$ in $rpoints$}
                        \State $l \gets$ calculate laminar length for $x$, $\varepsilon$ and $a$ using \eqref{eq:laminar_length}
                        \State $ls \gets ls \cup \{l\}$
                    \EndFor
                    \State $l_{avg} \gets$ an average of $ls$
                    \State plot the point ($\varepsilon$, $l_{avg}$) in a log-log scale
                \EndFor
            \EndFor
        \EndFor
    \end{algorithmic}
\end{algorithm}

\par
\textcolor{blue}{
The algorithm chooses a map $f_{p}$, a saddle-node bifurcation parameter $p^{*}$ and fixed points that are associated with the bifurcation.
Next, for $M$ parameters less than $p^{*}$ narrow passages are formed between the graph of $f_{p}$ and the fixed points.
The experiment proceeds by generating $N$ reinjected points in each of the narrow passages, computing their laminar lengths and calculating the average of them.
In the end, the narrow passage heights $\varepsilon$ are plotted against the corresponding average laminar lengths $l_{avg}$ in log-log scale.
}
\par
\textcolor{blue}{
The results of the experiment for $\mathcal{L}_{r}^{3}$ are shown in Figure~\ref{fig:characteristic_relation_fit}.
In addition to the data generated by the Algorithm~\ref{alg:char_rel}, linear fits of the data are shown.
Note that $l_{avg} \propto \varepsilon ^ {-1/2} \implies log_{10}(l_{avg}) \propto -1/2 \cdot \log_{10}(\varepsilon)$.
 Figure~\ref{fig:characteristic_relation_fit} shows that the slope of the linear fits is approximately $-1/2$.
Therefore, it can be concluded that the characteristic relation of type-I intermittency holds in this case.
}

\begin{figure}[!h]
    \centering
    \begin{subfigure}{0.49\textwidth}
        \centering
        \includegraphics[width=\textwidth]{Figures/characteristic_relation_fit{1}.png}
        \caption{}
    \end{subfigure}
    \hfill
    \begin{subfigure}{0.49\textwidth}
        \centering
        \includegraphics[width=\textwidth]{Figures/characteristic_relation_fit{2}.png}
        \caption{}
    \end{subfigure}
    \hfill
    \begin{subfigure}{0.49\textwidth}
        \centering
        \includegraphics[width=\textwidth]{Figures/characteristic_relation_fit{3}.png}
        \caption{}
    \end{subfigure}

    \caption{
        \textcolor{blue}{ 
        Results of the simulation \ref{alg:char_rel}. Parameters: $f_{p} = \mathcal{L}_{r}^{3}$, $p^{*} = 1+\sqrt{8}$, $xs = \{0.1599, 0.5143, 0.9563\}$, $cs = \{0.01, 0.03, 0.05, 0.07\}$, $N = 4000$, $M = 30$, $A = 10^{-5}$ and $B = 10^{-13}$.
        Colorful lines: linear fit.
        Constant $s$: slope of the linear fit.
        }
    }
    \label{fig:characteristic_relation_fit}
\end{figure}

\section{Ambiguous Bifurcation Diagram}
\label{sec:ambiguous_bif_diag}
\textcolor{blue}{
Bifurcation diagram (Remark~\ref{def: bif_diag}) is a common tool for scientists and researchers to study the long-term behavior of a DDS for varying parameters.
However, type-I intermittency poses a problem for the use of a bifurcation diagram.
The problem is that type-I intermittency causes the bifurcation diagram to be misleading in the proximity of a breakpoint.
}
\par
\textcolor{blue}{
How intermittency might cause the diagram to be misleading can be illustrated as follows:
Let $(X, f_{p})$ be a DDS.
Suppose a bifurcation diagram of $f_{p}$ is constructed for some $x_0$, $n_{total}$, $n_{last}$, and $p_{range}$ (see Algorithm~\ref{alg:bif_diag}).
Next, assume that for parameter $p$, $f_{p}$ is intermittent.
The bifurcation diagram is constructed by projecting trajectories $\mathcal{T}_{n_{total}-n_{last}}^{n_{total}}(f_{p}, x_0)$.
If the trajectory constructed for iterations $n \in [n_{total}-n_{last}, n_{total}]$ lies fully in the laminar phase, then only a finite number of dots will be displayed on the diagram.
On the other hand, if the parameter $n_{last}$ is increased, then the projected trajectory might reach the turbulent phase and the diagram will show a band of points.
This might not be a big deal for individual parameters $p$, but this phenomenon might affect a wide range of parameters $p$ near the breakpoint.
}
\par
\textcolor{blue}{
How a whole range of parameters might be affected can be illustrated as follows:
Suppose that $p_{R}, p_{B}$ are some parameters near the breakpoint $p_{bif}$.
Assume that $p_{R} \neq p_{B} \wedge p_{R} < p_{B} < p_{bif}$.
If $p_{R}$ and $p_{B}$ are close enough to $p_{bif}$ they both have intermittent trajectories.
Additionally, it follows that the laminar phases of $f_{p_{R}}$ are shorter than the laminar phases of $f_{p_{B}}$.
That is because the closer the parameter is to $p_{bif}$, the longer the laminar phases.
An example of this can be seen in Figure~\ref{fig:ambiguous_bif_diag}.
The red trajectory (which is partially hidden behind the blue one) has shorter laminar phases than the blue trajectory.
Notice the three letters, a, b, and c, in Figure~\ref{fig:ambiguous_bif_diag}.
These letters correspond to an iteration $n$ at which the a specific chaotic burst occurs.
Now, two bifurcation diagrams are created using these parameters:
\begin{enumerate}
    \item $n_{last} = c-(b-0.25(b-a))$
    \item $n_{last} = c-(b-0.75(b-a))$
\end{enumerate}
Other than that, both 1. and 2. have the same parameters: $n_{total} = 0.95c$ and some $x_0$, $p_{range}$ and $f_{p}$.
If such two bifurcation diagrams are constructed, they will both look very different in the proximity of $p_{bif}$.
}

\begin{figure}[!h]
    \centering
    \includegraphics[width=0.95\textwidth]{Figures/bif_diag_ambiguity_creation_sketch.png}
    \caption{
        \textcolor{blue}{
        Sketch describing how to create an ambiguous bifurcation diagram. 
        Red graph: $T^{17000}_{0}(\mathcal{P}_{4.47458285}, x_0)$. 
        Blue graph: $T^{17000}_{0}(\mathcal{P}_{4.47458285+4 \cdot 10^{-8}}, x_0)$. 
        Initial condition: $x_0 = 0.5$.
        }
    }
    \label{fig:ambiguous_bif_diag}
\end{figure}

\par
\textcolor{blue}{
Figure~\ref{fig:ambiguous_bif_diag_example} shows an example of $4$ bifurcation diagrams of $\mathcal{P}_{\varepsilon}$.
They are created for the same parameters except for $n_{last}$, which is different for each one of them.
A phenomenon, which shall be called ambiguity in the bifurcation diagram, can be observed.
Ambiguity in this context means that each bifurcation diagram looks drastically different for varying $n_{last}$.
}

\begin{figure}[!h]
    \centering
    \begin{subfigure}{0.85\textwidth}
        \centering
        \includegraphics[width=\textwidth]{Figures/pomeau_manneville_bif_comparison_big{1}.png}
        \caption{}
    \end{subfigure}
    \hfill
    \begin{subfigure}{0.85\textwidth}
        \centering
        \includegraphics[width=\textwidth]{Figures/pomeau_manneville_bif_comparison_big{2}.png}
        \caption{}
    \end{subfigure}
    \begin{subfigure}{0.85\textwidth}
        \centering
        \includegraphics[width=\textwidth]{Figures/pomeau_manneville_bif_comparison_big{3}.png}
        \caption{}
    \end{subfigure}
    \begin{subfigure}{0.85\textwidth}
        \centering
        \includegraphics[width=\textwidth]{Figures/pomeau_manneville_bif_comparison_big{4}.png}
        \caption{}
    \end{subfigure}

    \caption{
        \textcolor{blue}{ 
        Bifurcation diagrams of $\mathcal{P}_{\varepsilon}$ for $\varepsilon \in I := [4.4745829085, 4.4745829215]$.
        Interval $I$ is sampled to $400$ uniformly spaced points.
        Trajectories used for diagram construction:
        (a) $\mathcal{T}_{12000}^{25000}(\mathcal{P}_{\varepsilon}, x_0)$
        (b) $\mathcal{T}_{13900}^{25000}(\mathcal{P}_{\varepsilon}, x_0)$ 
        (c) $\mathcal{T}_{20000}^{25000}(\mathcal{P}_{\varepsilon}, x_0)$ 
        (d) $\mathcal{T}_{24000}^{25000}(\mathcal{P}_{\varepsilon}, x_0)$.
        Initial condition: $x_0 = 0.5$.
        }
    }
    \label{fig:ambiguous_bif_diag_example}
\end{figure}

\par
\textcolor{blue}{
The ambiguity in the bifurcation diagram could be misleading to someone who is not aware of it.
A tool that would warn researchers about intermittency and the ambiguity it causes might be useful.
Such a tool will be developed in the Chapter~\ref{chapter:intdetection}.
}

\endinput