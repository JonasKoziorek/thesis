\chapter{Intermittency Detection}
Last chapter introduced the problem of ambiguity of bifurcation diagram.
In this chapter we will develop an algorithm that will graphically warn about underlying intermittency and it's ambiguity.
This algorithm consists of 4 core parts

\begin{description}
    \item [UPO detection] -- detecting all periodic orbits
	\item [Global Search] -- searching through bifurcation diagram to find potential intervals with intermittency
	\item [Local Search] -- searching for breakpoint in an interval that contains intermittency
	\item [Coloring] -- coloring neighborhood of the breakpoint to warn about it
\end{description}

We will discuss each part in the following sections.

\section{UPO detection}
Our goal is to ultimately find regions in the bifurcation diagram where intermittency type I occurs.
As noted in chapter \ref{chap:intermittency_review} we suppose that intermittency type I is present at "breakpoints" in the bifurcation diagram.
Such breakpoint can be seen for example in figure \ref{fig:complex_logistic}.
\par
The breakpoints are characterized by shift from chaotic to periodic behavior.
Periodic behavior on one side of the breakpoint in the neighborhood of it always has some fixed period $n$.
Hence the system has $n$ stable fixed points on one side of the breakpoint.
On the other side the behavior is dynamic and there are no stable fixed points.
If we could quickly determine whether system for chosen parameter $p$ is periodic or not we could use this knowledge to find the breakpoints.
The reason for that is that on one side of the breakpoint the check of periodicity would always yield infinity and on the other side it would yield period $n$.
We could use this knowledge to get arbitralily close to the breakpoint.
\par
To check whether a system $f_P$ is $n$ periodic we just need to determine the number of stable fixed points of system $f^{n}_P$.
If number of the stable fixed points is $n$ then system $f_P$ is $n$ periodic.
If we know that $x_0$ is a stable fixed point of $f^{n}_P$ then we know that it is $n$ periodic point.
The remaining $n-1$ points of the stable periodic orbit can be found by iterating $f_P(x_0)$ $(n-1)$-times.
However how do we reliably and algorithmically get the first periodic orbit?
\par
Finding a fixed point of $f^{n}_{P}$ is a question of finding a root of $g(x) = f^{n}_{P}(x) - x$.
Standard root finding algorithm such as Newton-Raphson algorithm can be used to finds roots of $g(x)$.
However for high $n$ it becomes difficult to find these roots since there is too many of them and a chance of converging to a stable fixed point decreases.
Since our algorithm requires certainty that we found complete stable periodic orbit we decided to take another approach.
\par
Other option is to find all periodic orbits and determine their stability.
There exist quick algorithm to determine all periodic orbits.
By using it we will always have certainty that we found all stable periodic orbits.

\subsection{Schmelcher-Diakonos algorithm}
Schmelcher and Diakonos came up with a general algorithm for detecting complete set of unstable periodic orbits.
The algorithm transforms the original system so that it's unstable fixed points become stable.
Additionally their basins of attraction are long and convergence to each unstable orbit is probable.
However number of system transformations grow very quickly for high dimentional systems and computation becomes too long.
At the same time parameter $\lambda$ has to be specified correctly to ensure convergence but there is no general way of how to choose this parameter. \cite{Schmelcher1997}

\subsection{Davidchack-Lai algorithm}
Davidchack and Lai extended SD algorithm so that it works as a hybrid between Newton-Raphson algorithm and SD algorithm.
They propose that to find UPOs of period $n$ one can use UPOs of period $n-1$ and $n+1$.
This technique is supposed to reduce number of iterations significantly compared to SD algorithm. \cite{Davidchack1999}

\subsection{Our implementation}
DL algorithm is supposed to be superior to SD algorithm.
Even though there the DL algoritm is described in \cite{Davidchack1999,Davidchack2001,Klebanoff2001} we were not able to implement it in a way that would fulfill it's advertised performance.
Since the algorithm is over 20 years old and there are no implementations of it online we had to resort to our own version.
\par
Our version simply the DL evolution rule but doesn't use previously UPOs as seeds.
We choose seeds uniformly from an interval as it was suggested for SD algorithm \cite{Schmelcher1997}.
We use efficient binary search tree structure which makes the algorithm efficient enough for our use case.
Example of the results of the algorithm are shown in the figure \ref{fig:upo_search_example}.

\begin{figure}[!h]
    \centering
    \includegraphics[width=1.0\textwidth]{DDS/Figures/upo_search_example.png}
    \caption{All unstable periodic orbits}
    \label{fig:upo_search_example}
\end{figure}


\section{Global Search}
Thanks to algorithm from the previous section we are able to find potential intervals in the bifurcation diagram containing type-I intermittency.
We start by selecting range of parameters $(p_a, p_b)$ in which we would like to search for intermittency.
We discretize $(p_a, p_b)$ to $n$ uniformly spaced samples.
We go through each sample $p$ and check if it is $f_p$ is $m$-periodic.
We only check periods $m$ until a certain limit $m_{limit}$.
If we cannot detect any period we simply denote this boundary point as $m_{limit}+1$ which can be understood as infinity.
Since we know period of each sample we simply compare periods of neighboring samples.
If we spot a difference between period of sample $a$ and sample $b$, then a bifurcation must have occured in the interval $(a, b)$.
Additionally if $a=m_{limit}+1$ and $b \leq m_{limit}+1$ then we have found an interval which potentionally contains a breakpoint.
\par
Figure \ref{fig:bif_diag_search_example} illustrates global search through bifurcation diagram of logistic map for periods up to 18.
Two lines of the same color represent an interval in which bifurcation occurs.
We are looking for breakpoints associated with saddle-node bifurcations.
These breakpoints are hence also identified by this search.

\begin{figure}[!h]
    \centering
    \includegraphics[width=1.0\textwidth]{DDS/Figures/bif_diag_search_example.png}
    \caption{Global search example}
    \label{fig:bif_diag_search_example}
\end{figure}

\section{Local Search}
Once we identify suspicious intervals through global search we can search locally for precise location of a breakpoint.
Again we utilize the ability to determine number of period of $f_p$ for some $p$.
Since we know that to the left of the breakpoint there is no periodicity and to the right there is always the same periodicity, we can effectively search for the midpoint.
We can use similar approach as in the traditional binary search.
We start with an interval found by global search.
We know that left boundary has no periodicity and right boundary has periodicity.
We split the interval and check if the boundaries retain it's properties.
If property at the boundary changes we simply update the initial interval and start the algorithm recursively again.
This way we are able to precisely locate the breakpoint parameter.
\par
An example of the found breakpoint is illustrated in figure \ref{fig:break_point_search_example}.

\begin{figure}[!h]
    \centering
    \includegraphics[width=1.0\textwidth]{DDS/Figures/break_point_search_example.png}
    \caption{Local search example}
    \label{fig:break_point_search_example}
\end{figure}


\section{Coloring}
Coloring part is not implemented yet. Some statistical theory is needed.

\endinput